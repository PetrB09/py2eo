memory > xcm
memory > xlist
memory > xstr
memory > xhasattr
memory > xsupport
memory > xos
memory > xPermissionError
memory > xUnicodeEncodeError
memory > xunittest
memory > xexc
memory > xKeyError
memory > xentry
memory > xint
memory > xcx
memory > xTypeError
memory > x__name__
[] > test_spwd
  [args...] > unsupported
  [args...] > xunsupported
  memory > bogusForceDataize
  memory > xbogusForceDataize
  memory > xhack
  seq > @
    xhack.write
      []
        memory > xtest_getspall
        memory > xspwd
        memory > xtest_getspnam
        memory > xtest_getspnam_exception
        seq > @
          seq
            (((unsupported)) 0)
            (((unsupported)) 0)
            (((unsupported)) 0)
            xspwd.write ((((xsupport).ximport_module)) ("spwd"))
            (((unsupported)) (((xunittest).xTestCase)) (((((xunittest).xskipUnless)) (((((xhasattr)) ((xos)) ("geteuid")).and (((((xos).xgeteuid)) 0).eq 0))) ("root privileges required"))))
              seq
                xtest_getspall.write
                  [xself]
                    memory > xentries
                    seq > @
                      seq
                        xentries.write ((((xspwd).xgetspall)) 0)
                        bogusForceDataize.write ((((xself).xassertIsInstance)) ((xentries)) ((xlist)))
                        (((unsupported)) ((xentry)) ((xentries)))
                          bogusForceDataize.write ((((xself).xassertIsInstance)) ((xentry)) (((xspwd).xstruct_spwd)))
                xtest_getspnam.write
                  [xself]
                    memory > xentries
                    memory > xentry
                    memory > xrandom_name
                    memory > xbytes_name
                    seq > @
                      seq
                        xentries.write ((((xspwd).xgetspall)) 0)
                        ((xentries).not).if
                          bogusForceDataize.write ((((xself).xskipTest)) ("empty shadow password database"))
                        xrandom_name.write ((((unsupported)) ((xentries)) (0)).xsp_namp)
                        xentry.write ((((xspwd).xgetspnam)) ((xrandom_name)))
                        bogusForceDataize.write ((((xself).xassertIsInstance)) ((xentry)) (((xspwd).xstruct_spwd)))
                        bogusForceDataize.write ((((xself).xassertEqual)) (((xentry).xsp_namp)) ((xrandom_name)))
                        bogusForceDataize.write ((((xself).xassertEqual)) (((xentry).xsp_namp)) ((((unsupported)) ((xentry)) (0))))
                        bogusForceDataize.write ((((xself).xassertEqual)) (((xentry).xsp_namp)) (((xentry).xsp_nam)))
                        bogusForceDataize.write ((((xself).xassertIsInstance)) (((xentry).xsp_pwdp)) ((xstr)))
                        bogusForceDataize.write ((((xself).xassertEqual)) (((xentry).xsp_pwdp)) ((((unsupported)) ((xentry)) (1))))
                        bogusForceDataize.write ((((xself).xassertEqual)) (((xentry).xsp_pwdp)) (((xentry).xsp_pwd)))
                        bogusForceDataize.write ((((xself).xassertIsInstance)) (((xentry).xsp_lstchg)) ((xint)))
                        bogusForceDataize.write ((((xself).xassertEqual)) (((xentry).xsp_lstchg)) ((((unsupported)) ((xentry)) (2))))
                        bogusForceDataize.write ((((xself).xassertIsInstance)) (((xentry).xsp_min)) ((xint)))
                        bogusForceDataize.write ((((xself).xassertEqual)) (((xentry).xsp_min)) ((((unsupported)) ((xentry)) (3))))
                        bogusForceDataize.write ((((xself).xassertIsInstance)) (((xentry).xsp_max)) ((xint)))
                        bogusForceDataize.write ((((xself).xassertEqual)) (((xentry).xsp_max)) ((((unsupported)) ((xentry)) (4))))
                        bogusForceDataize.write ((((xself).xassertIsInstance)) (((xentry).xsp_warn)) ((xint)))
                        bogusForceDataize.write ((((xself).xassertEqual)) (((xentry).xsp_warn)) ((((unsupported)) ((xentry)) (5))))
                        bogusForceDataize.write ((((xself).xassertIsInstance)) (((xentry).xsp_inact)) ((xint)))
                        bogusForceDataize.write ((((xself).xassertEqual)) (((xentry).xsp_inact)) ((((unsupported)) ((xentry)) (6))))
                        bogusForceDataize.write ((((xself).xassertIsInstance)) (((xentry).xsp_expire)) ((xint)))
                        bogusForceDataize.write ((((xself).xassertEqual)) (((xentry).xsp_expire)) ((((unsupported)) ((xentry)) (7))))
                        bogusForceDataize.write ((((xself).xassertIsInstance)) (((xentry).xsp_flag)) ((xint)))
                        bogusForceDataize.write ((((xself).xassertEqual)) (((xentry).xsp_flag)) ((((unsupported)) ((xentry)) (8))))
                        (((unsupported)) (((((xself).xassertRaises)) ((xKeyError)))) ((xcx)))
                          bogusForceDataize.write ((((xspwd).xgetspnam)) ("invalid user name"))
                        bogusForceDataize.write ((((xself).xassertEqual)) ((((xstr)) (((xcx).xexception)))) ("'getspnam(): name not found'"))
                        bogusForceDataize.write ((((xself).xassertRaises)) ((xTypeError)) (((xspwd).xgetspnam)))
                        bogusForceDataize.write ((((xself).xassertRaises)) ((xTypeError)) (((xspwd).xgetspnam)) (0))
                        bogusForceDataize.write ((((xself).xassertRaises)) ((xTypeError)) (((xspwd).xgetspnam)) ((xrandom_name)) (0))
                        (((unsupported)) ((xUnicodeEncodeError)))
                          xbytes_name.write ((((xos).xfsencode)) ((xrandom_name)))
                          bogusForceDataize.write ((((xself).xassertRaises)) ((xTypeError)) (((xspwd).xgetspnam)) ((xbytes_name)))
            (((unsupported)) (((xunittest).xTestCase)) (((((xunittest).xskipUnless)) (((((xhasattr)) ((xos)) ("geteuid")).and (((((xos).xgeteuid)) 0).neq 0))) ("non-root user required"))))
              xtest_getspnam_exception.write
                [xself]
                  memory > xname
                  seq > @
                    seq
                      xname.write "bin"
                      (((unsupported)) ((xKeyError)))
                        (((unsupported)) (((((xself).xassertRaises)) ((xPermissionError)))) ((xcm)))
                          bogusForceDataize.write ((((xspwd).xgetspnam)) ((xname)))
                        bogusForceDataize.write ((((xself).xskipTest)) (("spwd entry %r doesn't exist: %s".mod (((unsupported)) ((xname)) ((xexc))))))
            ((x__name__).eq "__main__").if
              bogusForceDataize.write ((((xunittest).xmain)) 0)